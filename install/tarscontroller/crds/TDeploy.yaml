apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: tdeploys.k8s.tars.io
spec:
  conversion:
    strategy: Webhook
    webhook:
      conversionReviewVersions:
        - v1
      clientConfig:
        service:
          name: tars-webhook-service
          namespace: tars-system
          path: /conversion
        caBundle: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURBakNDQWVxZ0F3SUJBZ0lKQUpkZTVJYys0OWYxTUEwR0NTcUdTSWIzRFFFQkN3VUFNQll4RkRBU0JnTlYKQkFNTUMzUmhabTl3WlhKaGRHOXlNQjRYRFRJd01UQXhOREF5TkRJeE5sb1hEVE13TVRBeE1qQXlOREl4TmxvdwpGakVVTUJJR0ExVUVBd3dMZEdGbWIzQmxjbUYwYjNJd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3CmdnRUtBb0lCQVFDK0J3U09VS3E1RHhuY09wUEN2a0lxaEhGcGQyRFl5ZHlmSDJyRzFoUURhNC9oYmNYN1YrMUkKSXBETXUzK0t2UG1iODI1OFllQlpQTFlpYjRIYzhTRDFNcS9KOFhwOGtFZkE2aE1GWTFMbnBKWU5hZnpPNlhHNwpYa3BNazB4OEFPampFUkJYODJMVHZoTnNRTmdCYmh1dFk1MFY1ZXFiSCswVFVuQlFCT2ZxUVpzbnZTVDdqQ1dBCmt5VTJ3K2IvZHBCSnFVdFNkN3hNaGRHMlpPSVVObHREQ0dKalI1bk83Q1NUaHZaRTBaMG4vMDJkdUw2UCt0dFoKVTBla3ZoZUQwODA5TFpodElCWGtDeUpFT294OHA1RUNPUkpseE5JbHJEMm5VYzFpN3RyZFFZU2p3VG5lem1nZQpCMWJ0dXFiRHFXcGxOUUQ1UWo5TUVDZ2pnZnFJd2U2ZkFnTUJBQUdqVXpCUk1CMEdBMVVkRGdRV0JCUlZjbGhxCm5naEJiZDdaRERIamVzY0pteVdJM0RBZkJnTlZIU01FR0RBV2dCUlZjbGhxbmdoQmJkN1pEREhqZXNjSm15V0kKM0RBUEJnTlZIUk1CQWY4RUJUQURBUUgvTUEwR0NTcUdTSWIzRFFFQkN3VUFBNElCQVFBenhsdlhpSmQvMWxzbQoxT2pqVGFhQ1Nra1g4UStyTlM0QStHMlFDSFI2UjNNaTQzanJ3OEFhM3c3dTE0ZFRqS3ptTWQ5OVVRVzJDUjJiCnAyajVwYWJ4amx1UWZNTXQyTEFpWFF3SkVDcFFLTFhiSkFzcWQxQk9sWE1RM2lhenNKem9SUEZ3ZVRVTzdKVWcKQlVFR29vMjVQejFYVDlWTFNpSFNBM0gzTWVtczlycWE2cUlqUTF3TFNNZEpNVnJGenZRRDNaaDdZNFQyMFVxWApsNzYxS3JxRXZNbVRnTGtWV0RjeU5ScGtoRE9uTnFXWEFIZzZiWDJISUpXSEVPdk5melRtcUlpaE1vOVhxZ0Q3CjMydUxBMzc1cjBFSEJ3dGo4MFVNQmU5cWl3bHd0WkZpRW5iOHJ2elRCTGNhTzQrWTFMU1pTUC8yTWVBbGMrVUMKN1RPRDBuM0YKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQ==
  group: k8s.tars.io
  names:
    kind: TDeploy
    listKind: TDeployList
    plural: tdeploys
    shortNames:
      - td
    singular: tdeploy
  scope: Namespaced
  versions:
    - name: v1alpha1
      served: true
      storage: false
      schema:
        openAPIV3Schema:
          properties:
            apply:
              type: object
              properties:
                app:
                  type: string
                  pattern: ^[a-zA-Z][a-zA-Z0-9]*$
                  maxLength: 63
                server:
                  type: string
                  pattern: ^[a-zA-Z][a-zA-Z0-9]*$
                  maxLength: 63
                important:
                  type: integer
                  minimum: 1
                  maximum: 20
                  default: 3
                subType:
                  type: string
                  enum: [ tars,normal ]
                tars:
                  type: object
                  properties:
                    profile:
                      type: string
                    servants:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[a-zA-Z][a-zA-Z0-9]{0,59}Obj$
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                          thread:
                            type: integer
                            minimum: 1
                            maximum: 99
                            default: 3
                          capacity:
                            type: integer
                            minimum: 1
                            maximum: 3000000
                            default: 10000
                          connection:
                            type: integer
                            minimum: 1
                            maximum: 3000000
                            default: 10000
                          isTars:
                            type: boolean
                            default: true
                          isTcp:
                            type: boolean
                            default: true
                          timeout:
                            type: integer
                            minimum: -1
                            maximum: 6000000
                            default: 60000
                        required: [ name,port ]
                      minItems: 1
                    asyncThread:
                      type: integer
                      minimum: 0
                      maximum: 50
                      default: 3
                    template:
                      type: string
                      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                      maxLength: 253
                normal:
                  type: object
                  properties:
                    ports:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[A-Za-z0-9]([-A-Za-z0-9]*[A-Za-z0-9])?$
                            maxLength: 63
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                          isTcp:
                            type: boolean
                            default: true
                        required: [ name,port ]
                      minItems: 1
                  required: [ ports ]
                k8s:
                  type: object
                  properties:
                    env:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]$
                            maxLength: 63
                          value:
                            type: string
                          valueFrom:
                            type: object
                            properties:
                              fieldRef:
                                type: object
                                properties:
                                  apiVersion:
                                    type: string
                                  fieldPath:
                                    type: string
                              resourceFieldRef:
                                type: object
                                properties:
                                  containerName:
                                    type: string
                                  resource:
                                    type: string
                                  divisor:
                                    x-kubernetes-int-or-string: true
                                    default: "1"
                                required: [ resource ]
                              configMapKeyRef:
                                type: object
                                properties:
                                  name:
                                    type: string
                                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                    maxLength: 253
                                  key:
                                    type: string
                                    pattern: ^[A-Za-z0-9]([-A-Za-z0-9]*[A-Za-z0-9])?$
                                    maxLength: 63
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name,key ]
                              secretKeyRef:
                                type: object
                                properties:
                                  name:
                                    type: string
                                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                    maxLength: 253
                                  key:
                                    type: string
                                    pattern: ^[A-Za-z0-9]([-A-Za-z0-9]*[A-Za-z0-9])?$
                                    maxLength: 63
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name,key ]
                            oneOf:
                              - required: [ fieldRef ]
                              - required: [ resourceFieldRef ]
                              - required: [ configMapKeyRef ]
                              - required: [ secretKeyRef ]
                        oneOf:
                          - required: [ value ]
                          - required: [ valueFrom ]
                        required: [ name ]
                    envFrom:
                      type: array
                      items:
                        type: object
                        properties:
                          configMapRef:
                            type: object
                            properties:
                              name:
                                type: string
                                pattern: ^[a-zA-Z][a-zA-Z0-9-]{1,47}$
                              optional:
                                type: boolean
                                default: true
                            required: [ name ]
                          secretRef:
                            type: object
                            properties:
                              name:
                                type: string
                                pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                              optional:
                                type: boolean
                                default: true
                            required: [ name ]
                          prefix:
                            type: string
                            pattern: ^[A-Za-z_][A-Za-z0-9_]*$
                        oneOf:
                          - required: [ configMapRef ]
                          - required: [ secretRef ]
                    hostNetwork:
                      default: false
                      type: boolean
                    hostIPC:
                      default: false
                      type: boolean
                    hostPorts:
                      type: array
                      items:
                        type: object
                        properties:
                          nameRef:
                            type: string
                            pattern: ^[a-zA-Z0-9]([-a-zA-Z0-9]*[a-zA-Z0-9])?$
                            maxLength: 63
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                        required: [ nameRef,port ]
                    mounts:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[a-zA-Z][a-zA-Z0-9-]{1,47}$
                          source:
                            type: object
                            properties:
                              configMap:
                                type: object
                                properties:
                                  name:
                                    type: string
                                  items:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        key:
                                          type: string
                                          pattern: ^[-._a-zA-Z0-9]{1,253}$
                                        path:
                                          type: string
                                        mode:
                                          type: integer
                                          minimum: 0
                                          maximum: 0777
                                          default: 0644
                                    required: [ key,path ]
                                  defaultMode:
                                    type: integer
                                    minimum: 0
                                    maximum: 0777
                                    default: 0644
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name ]
                              secret:
                                type: object
                                properties:
                                  secretName:
                                    type: string
                                  items:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        key:
                                          type: string
                                          pattern: ^[-._a-zA-Z0-9]{1,253}$
                                        path:
                                          type: string
                                        mode:
                                          type: integer
                                          minimum: 0
                                          maximum: 0777
                                          default: 0644
                                    required: [ key,path ]
                                  defaultMode:
                                    type: integer
                                    minimum: 0
                                    maximum: 0777
                                    default: 0644
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name ]
                              emptyDir:
                                type: object
                                properties:
                                  medium:
                                    type: string
                                    enum: [ "",Memory ]
                                  sizeLimit:
                                    x-kubernetes-int-or-string: true
                              hostPath:
                                type: object
                                properties:
                                  path:
                                    type: string
                                  type:
                                    type: string
                                    enum: [ "",Directory,DirectoryOrCreate,FileOrCreate,File,Socket,CharDevice,BlockDevice ]
                                required: [ path,type ]
                              persistentVolumeClaim:
                                type: object
                                properties:
                                  claimName:
                                    type: string
                                  readOnly:
                                    type: boolean
                                    default: false
                            oneOf:
                              - required: [ configMap ]
                              - required: [ secret ]
                              - required: [ persistentVolumeClaim ]
                              - required: [ hostPath ]
                              - required: [ emptyDir ]
                          readOnly:
                            type: boolean
                            default: false
                          mountPath:
                            type: string
                          subPath:
                            type: string
                          mountPropagation:
                            type: string
                            enum: [ None,HostToContainer,Bidirectional ]
                          subPathExpr:
                            type: string
                    nodeSelector:
                      type: object
                      properties:
                        abilityPool:
                          type: object
                          properties:
                            values:
                              type: array
                              items:
                                type: string
                              maxItems: 0
                        nodeBind:
                          type: object
                          properties:
                            values:
                              type: array
                              items:
                                type: string
                              minItems: 1
                          required: [ values ]
                        publicPool:
                          type: object
                          properties:
                            values:
                              type: array
                              items:
                                type: string
                              maxItems: 0
                        daemonSet:
                          properties:
                            values:
                              items:
                                type: string
                              maxItems: 0
                              type: array
                          type: object
                      oneOf:
                        - required:
                            - nodeBind
                        - required:
                            - publicPool
                        - required:
                            - abilityPool
                        - required:
                            - daemonSet
                    notStacked:
                      default: false
                      type: boolean
                    podManagementPolicy:
                      default: Parallel
                      enum:
                        - OrderedReady
                        - Parallel
                      type: string
                    readinessGate:
                      type: string
                      enum: [ "",tars.io/active ]
                    replicas:
                      type: integer
                      minimum: 0
                      maximum: 99
                    serviceAccount:
                      type: string
                      pattern: ^[a-zA-Z][a-zA-Z0-9-]{1,47}$
                  required: [ replicas,nodeSelector ]
                release:
                  type: object
                  properties:
                    source:
                      type: string
                      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                      maxLength: 253
                    id:
                      type: string
                      pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]$
                      maxLength: 63
                    image:
                      type: string
                    secret:
                      type: string
                      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                      maxLength: 253
                  required: [ source,id,image ]
              required: [ app ,server,subType ]
              oneOf:
                - required: [ tars,k8s ]
                - required: [ normal,k8s ]
            approve:
              properties:
                person:
                  type: string
                  pattern: ^[a-zA-Z][a-zA-Z0-9_.-]{0,15}$
                reason:
                  type: string
                  maxLength: 300
                result:
                  type: boolean
                time:
                  type: string
                  format: date-time
              required:
                - person
                - time
                - result
                - reason
              type: object
            deployed:
              type: boolean
              default: false
          required: [ apply ]
          type: object
    - name: v1alpha2
      served: true
      storage: true
      schema:
        openAPIV3Schema:
          properties:
            apply:
              type: object
              properties:
                app:
                  type: string
                  pattern: ^[a-zA-Z][a-zA-Z0-9]*$
                  maxLength: 63
                server:
                  type: string
                  pattern: ^[a-zA-Z][a-zA-Z0-9]*$
                  maxLength: 63
                important:
                  type: integer
                  minimum: 1
                  maximum: 20
                  default: 3
                subType:
                  type: string
                  enum: [ tars,normal ]
                tars:
                  type: object
                  properties:
                    profile:
                      type: string
                      default: ""
                    servants:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[a-zA-Z][a-zA-Z0-9]{0,59}Obj$
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                          thread:
                            type: integer
                            minimum: 1
                            maximum: 99
                            default: 3
                          capacity:
                            type: integer
                            minimum: 1
                            maximum: 3000000
                            default: 10000
                          connection:
                            type: integer
                            minimum: 1
                            maximum: 3000000
                            default: 10000
                          isTars:
                            type: boolean
                            default: true
                          isTcp:
                            type: boolean
                            default: true
                          timeout:
                            type: integer
                            minimum: -1
                            maximum: 6000000
                            default: 60000
                        required: [ name,port ]
                    ports:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                            maxLength: 15
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                          isTcp:
                            type: boolean
                            default: true
                        required: [ name,port ]
                    asyncThread:
                      type: integer
                      minimum: 0
                      maximum: 50
                      default: 3
                    template:
                      type: string
                      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                      maxLength: 253
                  required: [ servants,template ]
                normal:
                  type: object
                  properties:
                    ports:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?$
                            maxLength: 15
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                          isTcp:
                            type: boolean
                            default: true
                        required: [ name,port ]
                  required: [ ports ]
                k8s:
                  type: object
                  properties:
                    abilityAffinity:
                      type: string
                      enum: [ AppRequired,ServerRequired, AppOrServerPreferred,None ]
                      default: AppOrServerPreferred
                    daemonSet:
                      type: boolean
                      default: false
                    env:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[-._a-zA-Z][-._a-zA-Z0-9]*$
                            maxLength: 63
                          value:
                            type: string
                          valueFrom:
                            type: object
                            properties:
                              fieldRef:
                                type: object
                                properties:
                                  apiVersion:
                                    type: string
                                  fieldPath:
                                    type: string
                              resourceFieldRef:
                                type: object
                                properties:
                                  containerName:
                                    type: string
                                  resource:
                                    type: string
                                  divisor:
                                    x-kubernetes-int-or-string: true
                                    default: "1"
                                required: [ resource ]
                              configMapKeyRef:
                                type: object
                                properties:
                                  name:
                                    type: string
                                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                    maxLength: 253
                                  key:
                                    type: string
                                    pattern: ^[A-Za-z0-9]([-A-Za-z0-9]*[A-Za-z0-9])?$
                                    maxLength: 63
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name,key ]
                              secretKeyRef:
                                type: object
                                properties:
                                  name:
                                    type: string
                                    pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                    maxLength: 253
                                  key:
                                    type: string
                                    pattern: ^[A-Za-z0-9]([-A-Za-z0-9]*[A-Za-z0-9])?$
                                    maxLength: 63
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name,key ]
                            oneOf:
                              - required: [ fieldRef ]
                              - required: [ resourceFieldRef ]
                              - required: [ configMapKeyRef ]
                              - required: [ secretKeyRef ]
                        oneOf:
                          - required: [ value ]
                          - required: [ valueFrom ]
                        required: [ name ]
                    envFrom:
                      type: array
                      items:
                        type: object
                        properties:
                          configMapRef:
                            type: object
                            properties:
                              name:
                                type: string
                                pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                maxLength: 253
                              optional:
                                type: boolean
                                default: true
                            required: [ name ]
                          secretRef:
                            type: object
                            properties:
                              name:
                                type: string
                                pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                                maxLength: 253
                              optional:
                                type: boolean
                                default: true
                            required: [ name ]
                          prefix:
                            type: string
                            pattern: ^[A-Za-z_][A-Za-z0-9_]*$
                        oneOf:
                          - required: [ configMapRef ]
                          - required: [ secretRef ]
                    hostIPC:
                      default: false
                      type: boolean
                    hostNetwork:
                      default: false
                      type: boolean
                    hostPorts:
                      type: array
                      items:
                        type: object
                        properties:
                          nameRef:
                            type: string
                            pattern: ^[a-zA-Z0-9]([-a-zA-Z0-9]*[a-zA-Z0-9])?$
                            maxLength: 63
                          port:
                            type: integer
                            minimum: 1
                            maximum: 65535
                        required: [ nameRef,port ]
                    mounts:
                      type: array
                      items:
                        type: object
                        properties:
                          name:
                            type: string
                            pattern: ^[a-zA-Z][a-zA-Z0-9-]{1,47}$
                          source:
                            type: object
                            properties:
                              configMap:
                                type: object
                                properties:
                                  name:
                                    type: string
                                  items:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        key:
                                          type: string
                                          pattern: ^[-._a-zA-Z0-9]{1,253}$
                                        path:
                                          type: string
                                        mode:
                                          type: integer
                                          minimum: 0
                                          maximum: 0777
                                          default: 0644
                                    required: [ key,path ]
                                  defaultMode:
                                    type: integer
                                    minimum: 0
                                    maximum: 0777
                                    default: 0644
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name ]
                              secret:
                                type: object
                                properties:
                                  secretName:
                                    type: string
                                  items:
                                    type: array
                                    items:
                                      type: object
                                      properties:
                                        key:
                                          type: string
                                          pattern: ^[-._a-zA-Z0-9]{1,253}$
                                        path:
                                          type: string
                                        mode:
                                          type: integer
                                          minimum: 0
                                          maximum: 0777
                                          default: 0644
                                    required: [ key,path ]
                                  defaultMode:
                                    type: integer
                                    minimum: 0
                                    maximum: 0777
                                    default: 0644
                                  optional:
                                    type: boolean
                                    default: true
                                required: [ name ]
                              emptyDir:
                                type: object
                                properties:
                                  medium:
                                    type: string
                                    enum: [ "",Memory ]
                                  sizeLimit:
                                    x-kubernetes-int-or-string: true
                              hostPath:
                                type: object
                                properties:
                                  path:
                                    type: string
                                  type:
                                    type: string
                                    enum: [ "",Directory,DirectoryOrCreate,FileOrCreate,File,Socket,CharDevice,BlockDevice ]
                                required: [ path,type ]
                              persistentVolumeClaim:
                                type: object
                                properties:
                                  claimName:
                                    type: string
                                  readOnly:
                                    type: boolean
                                    default: false
                                required: [ claimName ]
                              persistentVolumeClaimTemplate:
                                type: object
                                properties:
                                  metadata:
                                    type: object
                                    properties:
                                      labels:
                                        type: object
                                        additionalProperties:
                                          type: string
                                          pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]?$
                                          maxLength: 63
                                      annotations:
                                        type: object
                                        additionalProperties:
                                          type: string
                                          pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]?$
                                          maxLength: 63
                                  spec:
                                    type: object
                                    properties:
                                      accessModes:
                                        type: array
                                        items:
                                          type: string
                                          enum: [ ReadWriteOnce,ReadOnlyMany,ReadWriteMany ]
                                        minItems: 1
                                      volumeName:
                                        type: string
                                      storageClassName:
                                        type: string
                                      volumeMode:
                                        type: string
                                        enum: [ Block,Filesystem ]
                                      resources:
                                        type: object
                                        properties:
                                          limits:
                                            type: object
                                            properties:
                                              storage:
                                                x-kubernetes-int-or-string: true
                                                pattern: ^([+-]?[0-9.]+)([eEinumkKMGTP]*[-+]?[0-9]*)$
                                            required: [ storage ]
                                          requests:
                                            type: object
                                            properties:
                                              storage:
                                                x-kubernetes-int-or-string: true
                                                pattern: ^([+-]?[0-9.]+)([eEinumkKMGTP]*[-+]?[0-9]*)$
                                            required: [ storage ]
                                        required: [ requests ]
                                      selector:
                                        type: object
                                        properties:
                                          matchLabels:
                                            type: object
                                            additionalProperties:
                                              type: string
                                              pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]?$
                                              maxLength: 63
                                          matchExpressions:
                                            type: array
                                            items:
                                              type: object
                                              properties:
                                                key:
                                                  type: string
                                                  pattern: ^([A-Za-z0-9][-A-Za-z0-9_./]*)?[A-Za-z0-9]$
                                                  maxLength: 63
                                                operator:
                                                  type: string
                                                  enum: [ In,NotIn,Exists,DoesNotExist ]
                                                values:
                                                  type: array
                                                  items:
                                                    type: string
                                                    pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]?$
                                                    maxLength: 63
                                    required: [ accessModes,resources ]
                                required: [ spec ]
                              tLocalVolume:
                                type: object
                                property: { }
                            oneOf:
                              - required: [ configMap ]
                              - required: [ secret ]
                              - required: [ persistentVolumeClaim ]
                              - required: [ persistentVolumeClaimTemplate ]
                              - required: [ hostPath ]
                              - required: [ emptyDir ]
                              - required: [ tLocalVolume ]
                          readOnly:
                            type: boolean
                            default: false
                          mountPath:
                            type: string
                          subPath:
                            type: string
                          mountPropagation:
                            type: string
                            enum: [ None,HostToContainer,Bidirectional ]
                          subPathExpr:
                            type: string
                    nodeSelector:
                      type: array
                      items:
                        type: object
                        properties:
                          key:
                            type: string
                            pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9](/([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]){0,1}$
                            maxLength: 63
                          operator:
                            type: string
                            enum: [ In,NotIn,Exists,DoesNotExist,Gt,Lt ]
                          values:
                            type: array
                            items:
                              type: string
                              pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]?$
                              maxLength: 63
                        require: [ key,operator,values ]
                      default: [ ]
                    notStacked:
                      type: boolean
                      default: false
                    podManagementPolicy:
                      type: string
                      enum: [ OrderedReady,Parallel ]
                      default: Parallel
                    readinessGate:
                      type: string
                      enum: [ "",tars.io/active ]
                    replicas:
                      type: integer
                      minimum: 0
                      maximum: 99
                    resources:
                      type: object
                      properties:
                        requests:
                          type: object
                          properties:
                            memory:
                              type: string
                              pattern: ^([+-]?[0-9.]+)([eEinumkKMGTP]*[-+]?[0-9]*)$
                            cpu:
                              type: string
                              pattern: ^([+-]?[0-9.]+)([eEinumkKMGTP]*[-+]?[0-9]*)$
                        limits:
                          type: object
                          properties:
                            memory:
                              type: string
                              pattern: ^([+-]?[0-9.]+)([eEinumkKMGTP]*[-+]?[0-9]*)$
                            cpu:
                              type: string
                              pattern: ^([+-]?[0-9.]+)([eEinumkKMGTP]*[-+]?[0-9]*)$
                    serviceAccount:
                      type: string
                      pattern: ^[a-zA-Z][a-zA-Z0-9-]{1,47}$
                release:
                  type: object
                  properties:
                    source:
                      type: string
                      #                      pattern: ^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$
                      maxLength: 253
                    id:
                      type: string
                      pattern: ^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]$
                      maxLength: 63
                    image:
                      type: string
                    secret:
                      type: string
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*){0,1}$
                      maxLength: 253
                    time:
                      type: string
                      format: date-time
                  required: [ id,image ]
              required: [ app ,server,subType ]
              oneOf:
                - required: [ tars,k8s ]
                - required: [ normal,k8s ]
            approve:
              properties:
                person:
                  type: string
                  pattern: ^[a-zA-Z][a-zA-Z0-9_.-]{0,15}$
                reason:
                  type: string
                  maxLength: 300
                result:
                  type: boolean
                time:
                  type: string
                  format: date-time
              required:
                - person
                - time
                - result
                - reason
              type: object
            deployed:
              type: boolean
              default: false
          required: [ apply ]
          type: object
